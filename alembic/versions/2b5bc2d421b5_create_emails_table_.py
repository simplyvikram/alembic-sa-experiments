"""create emails table and mapping

Revision ID: 2b5bc2d421b5
Revises: 1a177f267570
Create Date: 2013-08-27 16:44:36.474158

** Alembic does not take care of ondelete cascades automatically,
so have to add them manually

"""

# revision identifiers, used by Alembic.
revision = '2b5bc2d421b5'
down_revision = '1a177f267570'

from alembic import op
import sqlalchemy as sa


def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    """
    alembic does not take care of ondelete cascades automatically,
    so have to add them
    """
    op.create_table('emails',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('address', sa.String(length=50), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['test_users.id'],
                            name='emails_user_id_fkey',
                            ondelete="CASCADE"),
    sa.PrimaryKeyConstraint('id')
    )
    ### end Alembic commands ###


def downgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('emails')
    ### end Alembic commands ###
